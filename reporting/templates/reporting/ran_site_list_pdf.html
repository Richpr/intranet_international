<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>RAN Sites Report</title>
    <style>
        /* ================== NOUVELLE CORRECTION ================== */
        @page {
            size: A4 landscape;
            margin: 0.5cm; /* Marge encore plus petite */
        }
        body { 
            font-family: sans-serif; 
            font-size: 6px; /* ðŸ‘ˆ RÃ©duit de 8px Ã  6px. C'est le minimum. */
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        th, td { 
            border: 1px solid #dddddd; 
            padding: 2px; /* ðŸ‘ˆ RÃ©duit de 4px Ã  2px. */
            text-align: left; 
            word-wrap: break-word;
        }
        th { 
            background-color: #f2f2f2; 
            white-space: nowrap;
        }
        /* ======================================================= */
    </style>
</head>
<body>
    <h1>RAN Sites Report</h1>
    <table class="table table-striped table-hover table-bordered">
        <thead>
            <tr>
                <th>Nom du site</th>
                <th>Id du site</th>
                <th>Pays</th>
                <th>Departement</th>
                <th>Commune</th>
                <th>Type de site</th>
                <th>Project Name</th>
                <th>Annee</th>
                <th>Mois</th>
                <th>Type de radio</th>
                <th>Type d'antenne</th>
                <th>Type d'enclosure</th>
                <th>Indoor equipement (BB/ML)</th>
                <th>INSTALLATION</th>
                <th>INTEGRATION</th>
                <th>SRS</th>
                <th>IMK</th>
                <th>EHS</th>
                <th>QA</th>
                <th>QA STATUS</th>
                <th>ATP</th>
                <th>COMMENT</th>
            </tr>
        </thead>
        <tbody>
            {% for site in sites %}
            <tr>
                <td>{{ site.name }}</td>
                <td>{{ site.site_id_client }}</td>
                <td>{{ site.project.country.name }}</td>
                <td>{{ site.departement.name|default:"" }}</td>
                <td>{{ site.location }}</td>
                <td>{{ site.site_type.name|default:"" }}</td>
                <td>{{ site.project.name }}</td>
                <td>{{ site.start_date|date:"Y" }}</td>
                <td>{{ site.start_date|date:"m" }}</td>
                <td>
                    {% for radio in site.radio_configurations.all %}
                        {{ radio.radio_type.name }} ({{ radio.quantity }}){% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </td>
                <td>{{ site.antenna_type.name|default:"" }}</td>
                <td>{{ site.enclosure_type.name|default:"" }}</td>
                <td>{{ site.bb_ml.name|default:"" }}</td>
                <td>{{ site.installation_status }}</td>
                <td>{{ site.integration_status }}</td>
                <td>{{ site.srs_status }}</td>
                <td>{{ site.imk_status }}</td>
                <td>{{ site.ehs_status }}</td>
                <td>{{ site.qa_result }}</td>
                <td>{{ site.qa_result }}</td>
                <td>{{ site.atp_status }}</td>
                <td>{{ site.comment }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>