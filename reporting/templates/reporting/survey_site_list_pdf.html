<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Survey Sites Report</title>
    <style>
        /* ================== CORRECTION ICI ================== */
        @page {
            size: A4 landscape; /* Force le mode paysage */
            margin: 1cm;       /* Réduit les marges */
        }
        body { 
            font-family: sans-serif; 
            font-size: 9px; /* Pas besoin de 8px ici, 9px devrait suffire */
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
        }
        th, td { 
            border: 1px solid #dddddd; 
            padding: 4px; /* Réduit la marge interne des cellules */
            text-align: left; 
            word-wrap: break-word; /* Force le texte à aller à la ligne si nécessaire */
        }
        th { 
            background-color: #f2f2f2; 
            white-space: nowrap; /* Garde les en-têtes sur une ligne */
        }
        /* ==================================================== */
    </style>
</head>
<body>
    <h1>Survey Sites Report</h1>
    <table>
        <thead>
            <tr>
                <th>Nom du site</th>
                <th>Id du site</th>
                <th>Pays</th>
                <th>Departement</th>
                <th>Commune</th>
                <th>Type de site</th>
                <th>Project Name</th>
                <th>Annee</th>
                <th>Mois</th>
                <th>SURVEY STATUT</th>
                <th>RAPPORT STATUT</th>
                <th>COMMENT</th>
            </tr>
        </thead>
        <tbody>
            {% for site in sites %}
            <tr>
                <td>{{ site.name }}</td>
                <td>{{ site.site_id_client }}</td>
                <td>{{ site.project.country.name }}</td>
                <td>{{ site.departement.name|default:"" }}</td>
                <td>{{ site.location }}</td>
                <td>{{ site.site_type.name|default:"" }}</td>
                <td>{{ site.project.name }}</td>
                <td>{{ site.start_date|date:"Y" }}</td>
                <td>{{ site.start_date|date:"m" }}</td>
                <td>{{ "N/A" }}</td>
                <td>{{ "N/A" }}</td>
                <td>{{ site.comment }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>